@page "/"
@using BlazorMovieLive.Models
@using BlazorMovieLive.Services
@inject TMDBClient TMDB

<PageTitle>Popular Movies</PageTitle>

<div class="container-xxl py-3">
	<div>
		<h1 class="display-6">
			<span class="text-primary">
				<i class="bi bi-fire"></i>
			</span>
			인기 영화 Popular Movies!
		</h1>
	</div>

	<div class="d-flex flex-column flex-md-row justify-content-between my-3">
		<div class="row row-cols-2 row-cols-lg-4 row-cols-xl-5 g-3 justify-content-center justify-content-md-start">
			@if (movies is not null)
			{
				@foreach (PopularMovie movie in movies.Results)
				{
					<div class="col">
						<MovieCard Movie="movie" />
					</div>
				}

			}
			else
			{
				for(int i = 0; i < 10; i++)
				{
					<div class="col">
						<MovieCard />
					</div>
				}
			}
		</div>
		
	</div>
</div>



@code {
	private PopularMoviePagedResponse? movies;

	[SupplyParameterFromQuery]
	public int Page { get; set; } = 1;

	protected override async Task OnInitializedAsync()
	{
		if (Page < 1) Page = 1;
		else if (Page > 500) Page = 500;
		movies = await TMDB.GetPopularMoviesAsync(Page);
	}
}
